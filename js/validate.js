ymq_define("Validate",["jquery","Config","Upload"],(function(r,e,a){return class o{constructor(){var r=this;r.instance=null,r.dom=null,r.config=e.getInstance(),r.upload=a.getInstance(),r.init()}initMemberVariables(){var e=this;e.selectDom=null,e.selectValueArray=[],e.selectValue="",e.domErrorArray=[],e.validateCount=0,e.validateArray=[],e.validateValue=[],e.form=r(e.config.form_box)}init(){this.initMemberVariables()}doValidate(){var e=this,a=e.selectDom.parents(".ymq-options-box");e.domErrorArray=[];var o=0,t=99999;e.validateArray.forEach((function(r){r.search("min_s:")>-1&&(o=Number(r.split(":")[1])),r.search("max_s:")>-1&&(t=Number(r.split(":")[1]))})),0==o&&0==t||(o==t?(e.selectValueArray.length>t-1?r(`#${a.prop("id")} input:checkbox:not([data-title]):not(:checked)`).prop("disabled",!0):r(`#${a.prop("id")} input:checkbox:not([data-title]):not(:checked)`).prop("disabled",!1),e.selectValueArray.length!=o&&(e.config.ymq_option_branding.lan.hasOwnProperty("total_s")?e.domErrorArray.push(e.config.ymq_option_branding.lan.total_s.replace("%s",o)):e.domErrorArray.push("You need to choose "+o+"."))):(e.selectValueArray.length<o&&(e.config.ymq_option_branding.lan.hasOwnProperty("min_s")?e.domErrorArray.push(e.config.ymq_option_branding.lan.min_s.replace("%s",o)):e.domErrorArray.push("You need to choose more than "+o+".")),e.selectValueArray.length>t&&(e.config.ymq_option_branding.lan.hasOwnProperty("max_s")?e.domErrorArray.push(e.config.ymq_option_branding.lan.max_s.replace("%s",t)):e.domErrorArray.push("You need to choose less than "+t+".")),e.selectValueArray.length>t-1?r(`#${a.prop("id")} input:checkbox:not([data-title]):not(:checked)`).prop("disabled",!0):r(`#${a.prop("id")} input:checkbox:not([data-title]):not(:checked)`).prop("disabled",!1))),e.validateArray.forEach((function(a){"required"==a&&(e.json.hasOwnProperty("isFile")?e.upload.fileData.hasOwnProperty(e.json.name)?r.isEmptyObject(e.upload.fileData[e.json.name])&&e.domErrorArray.push(e.config.ymq_option_branding.lan.require):e.domErrorArray.push(e.config.ymq_option_branding.lan.require):""==e.selectValue&&e.domErrorArray.push(e.config.ymq_option_branding.lan.require)),""!=e.selectValue&&(a.search("minchar:")>-1&&e.selectValue.length<a.split(":")[1]&&e.domErrorArray.push(e.config.ymq_option_branding.lan.min_char.replace("%s",a.split(":")[1])),a.search("maxchar:")>-1&&e.selectValue.length>a.split(":")[1]&&e.domErrorArray.push(e.config.ymq_option_branding.lan.max_char.replace("%s",a.split(":")[1])),a.search("min:")>-1&&Number(e.selectValue)<Number(a.split(":")[1])&&e.domErrorArray.push(e.config.ymq_option_branding.lan.min.replace("%s",a.split(":")[1])),a.search("max:")>-1&&Number(e.selectValue)>Number(a.split(":")[1])&&e.domErrorArray.push(e.config.ymq_option_branding.lan.max.replace("%s",a.split(":")[1])),"email"!=a||e.config.emailRe.test(e.selectValue)||e.domErrorArray.push(e.config.ymq_option_branding.lan.email),"integer"==a&&e.selectValue%1!=0&&e.domErrorArray.push(e.config.ymq_option_branding.lan.integer),"number"!=a||e.config.numberRe.test(e.selectValue)||e.domErrorArray.push(e.config.ymq_option_branding.lan.number),a.search("float:")>-1&&e.selectValue%1!=0&&e.selectValue.toString().split(".")[1].length>a.split(":")[1]&&e.domErrorArray.push(`${a.split(":")[1]}小数`))}))}validateOne(e,a=!1){var o=this;if(o.json=e,e&&e.validate){o.validateArray=e.validate.split("|"),o.selectDom=e.dom,o.selectValueArray=e.value,o.selectValue=e.value.join(","),o.doValidate();var t="";if(o.domErrorArray.length){o.domErrorArray.forEach((function(r){t+=`\n\t\t\t\t\t\t\t<div class="ymq-error-item">${r}</div>\n\t\t\t\t\t\t`}));var n=e.dom.parents(".ymq-options-box");if(0==o.validateCount&&a){if(n.offset().top+n.outerHeight()<r(window).scrollTop()){var i=n.offset().top-200;r("html, body").animate({scrollTop:i},500)}e.dom.focus()}o.validateCount++,e.dom.parents(".ymq-options-box").find("textarea").addClass("ymq_error_border"),e.dom.parents(".ymq-options-box").find(".selectDropdown").find("span").addClass("ymq_error_border"),e.dom.parents(".ymq-options-box").find("input[type='text']").addClass("ymq_error_border")}else e.dom.parents(".ymq-options-box").find("textarea").removeClass("ymq_error_border"),e.dom.parents(".ymq-options-box").find(".selectDropdown").find("span").removeClass("ymq_error_border"),e.dom.parents(".ymq-options-box").find("input[type='text']").removeClass("ymq_error_border");e.dom.parents(".ymq-options-box").find(".ymq-error-box").html(t)}}validateAll(r,e=!1){var a=this;a.validateCount=0,Object.keys(r).forEach((function(o){a.validateOne(r[o],e)}))}validateOneWithOutPrompt(r){var e=this;return e.json=r,!!(r&&r.validate&&(e.validateArray=r.validate.split("|"),e.selectDom=r.dom,e.selectValueArray=r.value,e.selectValue=r.value.join(","),e.doValidate(),e.domErrorArray.length))}validateAllWithOutPrompt(r){var e=this,a=!1;try{Object.keys(r).forEach((function(o){if(e.validateOneWithOutPrompt(r[o]))throw a=!0,new Error("breakForEach")}))}catch(r){if("breakForEach"!=r.message)throw r}return a}require(){}testValidate(r){r?this.success():this.error()}success(){}error(){this.dom.addClass("ymq_error")}static getInstance(){return this.instance||(this.instance=new o),this.instance}}}));